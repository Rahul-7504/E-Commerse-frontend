<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ShopEase - Modern E-Commerce</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="container">
        <nav class="navbar">
          <a href="#" class="logo">
            <i class="fas fa-shopping-bag"></i>
            ShopEase
          </a>

          <div class="nav-links">
            <a href="#product">Shop</a>
            <a href="#categories">Categories</a>
            <a href="#contact">Contact</a>
          </div>

          <div class="nav-icons">
            <div class="search-container">
              <input
                type="text"
                id="searchInput"
                placeholder="Search..."
                class="search-input"
              />
              <button class="search-button" onclick="searchProduct()">
                <i class="fas fa-search"></i>
              </button>
            </div>

            <a onclick="openUserModal()">
              <i class="fas fa-user user-icon"></i>
            </a>

            <!-- Modal -->
            <div id="userModal" class="modal-overlay">
              <div class="modal-content">
                <span class="modal-close" onclick="closeUserModal()">Ã—</span>

                <h1 class="user-icon-container">
                  <i class="fa-solid fa-circle-user user-icon-large"></i>
                </h1>                <div id="userData">Loading...</div>
              </div>
            </div>

            <a href="./components/shop.html">
              <i class="fas fa-shopping-cart"></i>
              <span>3</span>
            </a>
          </div>
        </nav>
      </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
      <div id="categories" class="container">
        <h1>Summer Collection 2023</h1>
        <p>
          Discover our new arrivals with up to 40% discount on selected items.
          Limited time offer!
        </p>
        <a href="#" class="btn">Shop Now</a>
        <a href="#" class="btn btn-outline">Learn More</a>
      </div>
    </section>

    <!-- Categories Section -->
    <!-- Corrected Categories Section -->
    <section class="container">
      <div class="section-title">
        <h2>Shop by Category</h2>
      </div>

      <div class="categories">
        <!-- Each category card should be entirely wrapped in the anchor tag -->
        <a
          href="./components/gamming.html?product=cloth"
          class="category-card category-link"
        >
          <i class="fas fa-tshirt"></i>
          <h3>Clothing</h3>
          <p>200+ Products</p>
        </a>

        <a
          href="./components/gamming.html?product=electronics"
          class="category-card category-link"
        >
          <i class="fas fa-laptop"></i>
          <h3>Electronics</h3>
          <p>150+ Products</p>
        </a>

        <a
          href="./components/gamming.html?product=home"
          class="category-card category-link"
        >
          <i class="fas fa-home"></i>
          <h3>Home</h3>
          <p>120+ Products</p>
        </a>

        <a
          href="./components/gamming.html?product=gaming"
          class="category-card category-link"
        >
          <i class="fas fa-gamepad"></i>
          <h3>Gaming</h3>
          <p>90+ Products</p>
        </a>
      </div>
    </section>

    <!-- Featured Products -->
    <section id="product" class="container">
      <div class="section-title">
        <h2>Featured Products</h2>
      </div>

      <div class="products">
        <!-- Products will be loaded dynamically from API -->
      </div>
    </section>

    <!-- Newsletter -->
    <section class="container">
      <div class="newsletter">
        <h2>Subscribe to Our Newsletter</h2>
        <p>Get the latest updates on new products and upcoming sales</p>
        <form class="newsletter-form">
          <input type="email" placeholder="Enter your email address" />
          <button type="submit">Subscribe</button>
        </form>
      </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
      <div class="container">
        <div class="footer-content">
          <div class="footer-col">
            <a href="#" class="logo">
              <i class="fas fa-shopping-bag"></i>
              ShopEase
            </a>
            <p>
              Your one-stop shop for all your needs. Quality products at
              affordable prices.
            </p>
            <div class="social-links">
              <a href="#"><i class="fab fa-facebook-f"></i></a>
              <a href="#"><i class="fab fa-twitter"></i></a>
              <a href="#"><i class="fab fa-instagram"></i></a>
              <a href="#"><i class="fab fa-youtube"></i></a>
            </div>
          </div>

          <div class="footer-col">
            <h3>Quick Links</h3>
            <ul class="footer-links">
              <li><a href="#">Home</a></li>
              <li><a href="#">Shop</a></li>
              <li><a href="#">About Us</a></li>
              <li><a href="#">Contact</a></li>
              <li><a href="#">FAQ</a></li>
            </ul>
          </div>

          <div class="footer-col">
            <h3>Customer Service</h3>
            <ul class="footer-links">
              <li><a href="#">My Account</a></li>
              <li><a href="#">Order Tracking</a></li>
              <li><a href="#">Wishlist</a></li>
              <li><a href="#">Returns & Exchanges</a></li>
              <li><a href="#">Shipping Info</a></li>
            </ul>
          </div>

          <div class="footer-col">
            <h3>Contact Info</h3>
            <p>
              <i class="fas fa-map-marker-alt"></i> 123 Street, City, Country
            </p>
            <p><i class="fas fa-phone"></i> +1 234 567 890</p>
            <p><i class="fas fa-envelope"></i> info@shopease.com</p>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2023 ShopEase. All Rights Reserved.</p>
        </div>
      </div>
    </footer>

    <script>
      // Check registration and authentication status when page loads
      document.addEventListener("DOMContentLoaded", function () {
        const isRegistered = localStorage.getItem("isRegistered") === "true";
        const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";

        if (!isRegistered) {
          // Redirect to register page if not registered
          window.location.href = "./components/register.html";
        } else if (!isLoggedIn) {
          // Redirect to login page if registered but not logged in
          window.location.href = "./components/login.html";
        } else {
          // Show main content if registered and logged in
          document.getElementById("app-content").style.display = "block";

          // Display user info
          const userEmail = localStorage.getItem("userEmail");
          const userProfile = document.getElementById("userProfile");
          if (userEmail && userProfile) {
            userProfile.title = `Logged in as ${userEmail}`;
          }

          // Update cart count
          const cartCount = localStorage.getItem("cartCount");
          if (cartCount) {
            document.getElementById("cartCount").textContent = cartCount;
          }

          // Load products
          if (typeof fetchProducts === "function") {
            fetchProducts();
          }
        }
      });
      function searchProduct() {
        const searchInput = document.getElementById("searchInput");
        const searchValue = searchInput.value;
        if (searchValue.trim()) {
          searchInput.value = "";
          window.location.href = `./components/productSearch.html?query=${encodeURIComponent(
            searchValue
          )}`;
        }
      }

      function openUserModal() {
        document.getElementById("userModal").style.display = "flex";
const email=localStorage.getItem("userEmail")

        // Fetch user info from API (replace this with your actual API)
        fetch(`https://e-commece-dc2r.onrender.com/api/user/userinfo/${email}`)
          .then((res) => res.json())
          .then((data) => {
            console.log(data)
            document.getElementById("userData").innerHTML = `
  <div class="user-info-container">
   
    <div class="info-row">
      <span class="info-label">Email</span>
      <a href="mailto:${email}" class="info-value email">${email}</a>
    </div>
    <div class="logout-container">
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

  </div>
`;
          })
          .catch((err) => {
            document.getElementById("userData").innerHTML =
              "Error loading user data.";
            console.error(err);
          });
      }

      function logout(){
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userEmail')
        window.location.href = "components/login.html";


      }

      function closeUserModal() {
        document.getElementById("userModal").style.display = "none";
      }

      // Optional: Close modal on background click
      window.onclick = function (event) {
        const modal = document.getElementById("userModal");
        if (event.target === modal) {
          closeUserModal();
        }
      };
    </script>
    <script src="./js/api.js"></script>
  </body>
</html>
